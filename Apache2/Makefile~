IMAGE_NAME=maho/apache2

DOCKERFILE=Dockerfile.apache2_fg
PORTCONF1=-p 8080:80
PORTCONF2=-p 8081:80

#DOCKERFILE=Dockerfile.w_supervisor
#PORTCONF=-p 8080:80 -p 20022:22


build:
	rm -f Dockerfile
	ln -s $(DOCKERFILE) Dockerfile
	docker build -t $(IMAGE_NAME) .

start:
	docker run --link mysql:db -d $(PORTCONF1) $(IMAGE_NAME)
	docker run --link mysql:db -d $(PORTCONF2) $(IMAGE_NAME)
	docker ps $(IMAGE_NAME)

stop:
	docker stop $(shell docker ps -q -s $(IMAGE_NAME))

status:
	docker ps $(IMAGE_NAME)

clean1:
	docker ps $(IMAGE_NAME)
	docker rm $(shell docker ps -a -s -q)

clean2:	
	docker images $(IMAGE_NAME)
	docker rmi $(IMAGE_NAME)
	rm -f Dockerfile